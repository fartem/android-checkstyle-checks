plugins {
    id 'java'
    id 'checkstyle'
    id 'de.aaschmid.cpd' version '3.2'
}

group 'com.smlnskgmail.jaman.checkstyle'
version '1.2.2'

checkstyle {
    toolVersion '8.41.1'
    ignoreFailures false
    showViolations true

    def checkstyleConfigPath = "$rootDir/checkstyle.xml"
    def checkstyleConfig = new File(checkstyleConfigPath)
    if (!checkstyleConfig.exists()) {
        new URL(
                "https://raw.githubusercontent.com/fartem/repository-rules/master/rules/java/checkstyle/checkstyle.xml"
        ).withInputStream {
            i -> checkstyleConfig.withOutputStream {
                it << i
            }
        }
    }

    configFile file(checkstyleConfigPath)
}

checkstyleMain {
    source = 'src/main/java'
}

cpd {
    language = 'java'
}

cpdCheck {
    exclude '*.java'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'com.puppycrawl.tools:checkstyle:8.41.1'
}
